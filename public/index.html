<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Runners Club Project</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<body>
    <div id="login">
        <div class="loginStatus">
            <p class="loader"></p>
            <p>Authenticating</p>
        </div>
        <h3>LOGIN</h3>
        <p>username</p><input id="name" type="text">
        <p>password</p><input id="pass" type="password">
        <input id="submit" type="submit" value="SUBMIT" onclick="login()">
    </div>
    <div id="sidepanel">
        <input id="payMembership" name="payMembership" type="button" value="Pay monthly fee">

        <button id="addCust">Add customer</button>
    </div>
    <div id="panel"> 
        <div id="customersList">

        </div>
    </div>

    <div class="modal">
        <div class="modalBox">
            <span class="close">&times;</span>
            <div id="addCustomer">
                <form id="formAddCustomer" action="/">
                <span>First name:</span><input type="text" name="fName" id="addFName">
                <span>Last name:</span><input type="text" name="lName" id="addLName">
                <span>Balance:</span><input type="text"  name="balance" id="addBalance">
                <span>Direct Debit:</span><input type="checkbox" name="directDebit" id="addDDebit">
                <span>Membership:</span><input type="checkbox" name="membership" id="addMembership">
                <span>5k time:</span><input type="text" name="fivekTime" id="add5kTime">
                <input type="submit" value="Submit" id="btnAddCustomer"></form>
            </div>
            <div id="formChangeBalance">
                <form id="formDeposit" action="/">
                    <input type="hidden" name="depositID" id="depositID">
                    <span>Deposit:</span><input type="text" name="depositValue" id="changeDeposit">
                    <input type="submit" value="Submit"></form>
                <form id="formWithdraw" action="/">
                    <input type="hidden" name="withdrawID" id="withdrawID">
                    <span>Withdraw:</span><input type="text" name="withdrawValue" id="changeWithdraw">
                    <input type="submit" value="Submit"></form>
            </div>
            <div id="formDeleteCustomer">
                <form id="formDelete" action="/">
                    <input type="hidden" name="deleteID" id="deleteID">
                    <input type="submit" value="Delete" id="btnDelete">
                </form>
            </div>
        </div>
    </div>
    
    <script src="app.js"></script>
    <script
        src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
    <script>
        $('#formAddCustomer').submit(function(e){
        isCustomerValid(validationData);
        e.preventDefault();
        if(isCustomerValid(validationData)) {
            $.ajax({
            url: $(this).attr("href"),
            type:'post',
            data:$('#formAddCustomer').serialize(),
            success:function(){
                alert("Customer added!");
                makeRequest("customers.json");
                $('form').trigger("reset");
                validationData = {
                    "fName": false,
                    "lName": false,
                    "balance": false,
                    "fiveKTime": false
                }

            }
        });
        }
        else {
            console.log("There was an error while adding a new customer");
        }
        
        });
        $('#formDeposit').submit(function(e){
        e.preventDefault();
        $.ajax({
            url: $(this).attr("href"),
            type:'post',
            data:$('#formDeposit').serialize(),
            success:function(){
                alert("Deposit successful!");
                makeRequest("customers.json");
                $('form').trigger("reset");       
            }
        });
        });
        $('#formWithdraw').submit(function(e){
        e.preventDefault();
        $.ajax({
            url: $(this).attr("href"),
            type:'post',
            data:$('#formWithdraw').serialize(),
            success:function(){
                alert("Withdraw successful!");
                makeRequest("customers.json");
                $('form').trigger("reset");
            }
        });
        });
        $('#formDelete').submit(function(e){
        e.preventDefault();
        $.ajax({
            url: $(this).attr("href"),
            type:'post',
            data:$('#formDelete').serialize(),
            success:function(){
                alert("Deletion successful!");
                makeRequest("customers.json");
            }
        });
        });
        $('#payMembership').click(function(e){
        e.preventDefault();
        $.ajax({
            url: $(this).attr("href"),
            type:'post',
            data: JSON.stringify({ "reqID": "payMembership" }),
            contentType: 'application/json',
            success:function(){
                alert("Payment successful!");
                makeRequest("customers.json");
            }
        });
        });
    </script>
</body>
</html>